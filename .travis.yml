sudo: required
language: python
python:
- '3.5'
cache: pip
services:
- docker
before_install:
- openssl aes-256-cbc -K $encrypted_2e3704f31d08_key -iv $encrypted_2e3704f31d08_iv
  -in swarm-master.tar.gz.enc -out swarm-master.tar.gz -d
- tar zxvf swarm-master.tar.gz && rm swarm-master.tar.gz
- echo "make deploy" > deploy.sh && chmod +x deploy.sh
- pip install -U pip
- pip install wheel
env:
  global:
  - PIP_WHEEL_DIR=$HOME/.cache/pip/wheels
  - PIP_FIND_LINKS=file://$HOME/.cache/pip/wheels
install:
- pip wheel -r requirements.txt
- pip install -r requirements.txt
script:
- cd src && py.test --cov=./
- cd $TRAVIS_BUILD_DIR
deploy:
  skip_cleanup: true
  provider: script
  script: "$TRAVIS_BUILD_DIR/deploy.sh"
  on:
    branch: master
notifications:
  slack:
    rooms:
      secure: ndEZPN7Vu6V2l3OTXIsFU7eu8UhZfYOa62iFMQOViL0IWL38tBFs4REx6d+bgyshzHEnlHiwNWD2QzlbcDxtmfdcFWZ9tM8rbMyTbrlC3qMcKvykRTzB9xYdF6Y5mOxU8wEtnKINmz/6qWmBh3QRcB5j6e+FiT+0+s5MSkUbQTjOVzw/0CGYxsdswc4pqfJx8ubWbxk8SaftDSOW0GB6fleDrWlOtitaYY1QmhoxmjOgcFJ+DAVXGs9mmDGLUhnNLsism2bLbt5mJT3eHatvto0ZFy77uUOcppYQFeRVsJtaPSoczrGQnNG1IgLL758+y5yryRNl6V+uHMYme6fdP/iB8Dmd1WLRMQdP2kjLqUd1EonROJnOJGhLWZftdJkjB0JxOQp0zR71u8+8b5G3Uv4RKdVshCeH9YqHScamR/FVMWwQB86LdjdUW9XCEmvj4LRvMVuByvsfKcVvKGzWhd5J3LWSuY/Gv1ScONDasr4eP/iVj68tHh3BHm7mA3YDoRRMjTYxPYM7+fdAD8p4S1d5Drz8u5v73EPRnrjkHTmXrBv34RppIKxnymy/1ldwJskoS7f7K4ZMZGD/pFkO7Ujetk6Rf7vQmj3CRLQK68xseOXsF3/BQYcurlgveCux5ao8VQVizFatIgZKspec2Sv0CVBdn9vPzVEm7In8zjc=
